<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Descubra o Dia da Sua Morte</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel&family=Playfair+Display&display=swap');
    /* Fonte elegante e misteriosa */
    body {
      margin: 0; padding: 0;
      background: url('https://img.freepik.com/fotos-premium/arvore-preta-seca-sem-folhas-com-ceu-vermelho-sangue-assustador-fundo-de-natureza-de-arvore-de-horror-assustador-para-o-halloween_696486-50.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Playfair Display', serif;
      color: #eee;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow-x: hidden;
    }
    #container {
      background: rgba(0, 0, 0, 0.85);
      padding: 20px 30px;
      border-radius: 12px;
      max-width: 400px;
      width: 95%;
      box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
    }
    h1 {
      font-family: 'Cinzel', serif;
      font-size: 2.5rem;
      margin-bottom: 20px;
      text-align: center;
      color: #ff3b3b;
      text-shadow: 0 0 8px #ff0000;
    }
    .question {
      margin-bottom: 25px;
    }
    .question p {
      font-size: 1.2rem;
      margin-bottom: 12px;
    }
    button.option {
      background-color: transparent;
      border: 2px solid #ff3b3b;
      color: #ff3b3b;
      font-size: 1rem;
      padding: 10px 18px;
      margin: 0 6px 10px 0;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 70px;
    }
    button.option.selected, button.option:hover {
      background-color: #ff3b3b;
      color: #000;
    }
    input[type="text"], input[type="tel"] {
      width: 100%;
      padding: 10px;
      font-size: 1.1rem;
      border-radius: 6px;
      border: 2px solid #ff3b3b;
      background: #111;
      color: #eee;
      box-sizing: border-box;
    }
    #next-btn {
      background-color: #ff3b3b;
      color: black;
      border: none;
      padding: 12px 0;
      width: 100%;
      font-size: 1.25rem;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
      display: none;
      font-weight: bold;
      letter-spacing: 1.1px;
    }
    #next-btn:hover {
      background-color: #e63636;
    }
    #result {
      display: none;
      margin-top: 15px;
      font-size: 1.15rem;
      line-height: 1.4;
      font-family: 'Playfair Display', serif;
      text-align: center;
      color: #ff5959;
    }
    #result strong {
      color: #fff;
    }
    #ad-space {
      margin-top: 25px;
      height: 90px;
      background: #000;
      color: #555;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
      font-size: 1.1rem;
      border-radius: 10px;
    }
    /* Responsivo para celular */
    @media (max-width: 480px) {
      #container {
        max-width: 90vw;
        padding: 15px 20px;
      }
      h1 {
        font-size: 2rem;
      }
      button.option {
        min-width: 60px;
        margin-bottom: 8px;
      }
      #next-btn {
        font-size: 1.1rem;
      }
      #result {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="container">
    <h1>Descubra o Dia da Sua Morte</h1>

    <!-- Perguntas: Exemplo igual ao último código -->
    <div id="step1" class="question">
      <p>Você fuma?</p>
      <button class="option" data-value="sim">Sim</button>
      <button class="option" data-value="nao">Não</button>
      <button class="option" data-value="as-vezes">Às vezes</button>
    </div>

    <div id="step2" class="question" style="display:none;">
      <p>Você já teve alguma doença grave? (ex: diabetes, pressão alta)</p>
      <button class="option" data-value="sim">Sim</button>
      <button class="option" data-value="nao">Não</button>
    </div>

    <div id="step3" class="question" style="display:none;">
      <p>Você pratica exercícios regularmente?</p>
      <button class="option" data-value="sim">Sim</button>
      <button class="option" data-value="nao">Não</button>
    </div>

    <div id="step4" class="question" style="display:none;">
      <p>Qual o seu nome?</p>
      <input type="text" id="name" placeholder="Digite seu nome" autocomplete="off" />
    </div>

    <div id="step5" class="question" style="display:none;">
      <p>Qual a sua data de nascimento?</p>
      <input type="tel" id="birthdate" placeholder="dd/mm/aaaa" maxlength="10" autocomplete="off" />
    </div>

    <button id="next-btn">Próximo</button>

    <div id="result"></div>

    <div id="ad-space">Anúncio aqui</div>
  </div>

  <script>
    const steps = ['step1', 'step2', 'step3', 'step4', 'step5'];
    let currentStep = 0;
    const answers = {};
    const usedNames = JSON.parse(localStorage.getItem('usedNames') || '[]');

    const nextBtn = document.getElementById('next-btn');
    const resultDiv = document.getElementById('result');

    function showStep(index) {
      steps.forEach((stepId, i) => {
        document.getElementById(stepId).style.display = i === index ? 'block' : 'none';
      });
      nextBtn.style.display = 'none'; // Esconde botão até escolher opção
      resultDiv.style.display = 'none';
    }

    // Exibir passo inicial
    showStep(currentStep);

    // Botões de opção
    document.querySelectorAll('.option').forEach(btn => {
      btn.addEventListener('click', e => {
        const stepId = steps[currentStep];
        answers[stepId] = btn.getAttribute('data-value');
        // Marca selecionado visualmente
        btn.parentElement.querySelectorAll('button.option').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        nextBtn.style.display = 'block';
      });
    });

    // Inputs nome e data com botão próximo
    const inputName = document.getElementById('name');
    const inputBirth = document.getElementById('birthdate');

    inputName.addEventListener('input', () => {
      nextBtn.style.display = inputName.value.trim() ? 'block' : 'none';
    });

    // Máscara simples para data dd/mm/aaaa e teclado numérico
    inputBirth.addEventListener('input', e => {
      let val = e.target.value.replace(/\D/g, '');
      if(val.length > 8) val = val.slice(0,8);
      if(val.length > 4) val = val.slice(0,2) + '/' + val.slice(2,4) + '/' + val.slice(4);
      else if(val.length > 2) val = val.slice(0,2) + '/' + val.slice(2);
      e.target.value = val;
      // Exibir botão próximo só se a data estiver completa
      if(/^\d{2}\/\d{2}\/\d{4}$/.test(e.target.value)) {
        nextBtn.style.display = 'block';
      } else {
        nextBtn.style.display = 'none';
      }
    });

    // Função para calcular idade com base na data dd/mm/aaaa
    function calcularIdade(dataNascimento) {
      const partes = dataNascimento.split('/');
      if(partes.length !== 3) return 0;
      const dia = parseInt(partes[0],10);
      const mes = parseInt(partes[1],10) - 1;
      const ano = parseInt(partes[2],10);
      const hoje = new Date();
      const nascimento = new Date(ano, mes, dia);
      let idade = hoje.getFullYear() - nascimento.getFullYear();
      const m = hoje.getMonth() - nascimento.getMonth();
      if (m < 0 || (m === 0 && hoje.getDate() < nascimento.getDate())) {
          idade--;
      }
      return idade;
    }

    // Próximo passo no clique do botão
    nextBtn.onclick = () => {
      // Validar nome repetido
      if (steps[currentStep] === 'step4') {
        const nomeDigitado = inputName.value.trim().toLowerCase();
        if (usedNames.includes(nomeDigitado)) {
          alert('Você já consultou com esse nome. Use outro nome para consultar novamente.');
          return;
        }
        answers.name = inputName.value.trim();
      }

      // Salvar resposta dos inputs
      if (steps[currentStep] === 'step4') {
        answers.name = inputName.value.trim();
      } else if (steps[currentStep] === 'step5') {
        answers.birthdate = inputBirth.value.trim();
      }

      if(currentStep < steps.length - 1) {
        currentStep++;
        showStep(currentStep);
        // Se for input nome ou data, esconder botão e esperar input
        if (steps[currentStep] === 'step4') {
          nextBtn.style.display = 'none';
        }
        if (steps[currentStep] === 'step5') {
          nextBtn.style.display = 'none';
        }
      } else {
        // Último passo: mostrar resultado
        mostrarResultado();
      }
    };

    // Gerar causa da morte (simplificado)
    function gerarCausa(answers) {
      // Base simples de causas
      if (answers.step2 === 'sim' && answers.step1 === 'sim') {
        return 'Infarto causado por combinação de tabagismo e doença grave.';
      } else if (answers.step2 === 'sim') {
        return 'Doença cardíaca causada por pressão alta ou diabetes.';
      } else if (answers.step3 === 'nao') {
        return 'Doença causada por sedentarismo e falta de cuidados.';
      } else if (answers.step1 === 'sim') {
        return 'Complicações pulmonares devido ao tabagismo.';
      }
      return 'Causa natural relacionada à idade e fatores genéticos.';
    }

    // Gera descrição extra para o final
    function gerarDescricao(causa) {
      if (causa.includes('Infarto')) return 'Infarto agudo do miocárdio causado por maus hábitos.';
      if (causa.includes('Doença cardíaca')) return 'Doença cardíaca crônica decorrente de pressão alta e diabetes.';
      if (causa.includes('sedentarismo')) return 'Doença causada pela falta de atividade física e má alimentação.';
      if (causa.includes('tabagismo')) return 'Complicações pulmonares causadas pelo tabagismo.';
      return 'Causa natural, sem fatores agravantes.';
    }

    // Cidades próximas fixas
    const cidades = ['Jaguaribe', 'Jaguaribara', 'Limoeiro', 'Itaiçaba', 'Aracati', 'Morada Nova'];

    // Calcula idade e ano da morte, hora e condição do dia
    function calcularDadosFinais(birthdate, causa) {
      const idadeAtual = calcularIdade(birthdate);
      let baseVida = 70;
      if(causa.includes('Infarto')) baseVida = 60;
      else if(causa.includes('Doença cardíaca')) baseVida = 55;
      else if(causa.includes('sedentarismo')) baseVida = 63;
      else if(causa.includes('tabagismo')) baseVida = 58;

      let anosRestantes = baseVida - idadeAtual;
      if (anosRestantes <= 0) anosRestantes = 1;
      const anoMorte = new Date().getFullYear() + anosRestantes;

      // Escolhe cidade aleatória da lista
      const cidade = cidades[Math.floor(Math.random() * cidades.length)];

      // Hora da morte aleatória (entre 0 e 23 horas)
      const hora = Math.floor(Math.random() * 24) + ':00';

      // Condição do dia aleatória
      const condicoes = ['nublado', 'ensolarado', 'chuvoso', 'de noite', 'tempestuoso', 'com neblina'];
      const condicao = condicoes[Math.floor(Math.random() * condicoes.length)];

      return { idade: idadeAtual + anosRestantes, ano: anoMorte, cidade, hora, condicao };
    }

    // Mostrar resultado formatado
    function mostrarResultado() {
      const nome = answers.name;
      const causa = gerarCausa(answers);
      const descricao = gerarDescricao(causa);
      const dados = calcularDadosFinais(answers.birthdate, causa);

      // Salva o nome para não repetir consulta
      usedNames.push(nome.toLowerCase());
      localStorage.setItem('usedNames', JSON.stringify(usedNames));

      const texto = `
        <p><strong>${nome}</strong>, seu fim acontecerá exatamente assim:</p>
        <p>${descricao}</p>
        <p><strong>Doença causada:</strong> ${causa}</p>
        <p><strong>Idade que você vai morrer:</strong> ${dados.idade} anos</p>
        <p><strong>Ano exato da morte:</strong> ${dados.ano}</p>
        <p><strong>Cidade onde você vai morrer:</strong> ${dados.cidade}</p>
        <p><strong>Hora exata:</strong> ${dados.hora}</p>
        <p><strong>Condição do dia:</strong> ${dados.condicao}</p>
      `;

      document.getElementById('container').style.display = 'none';
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = texto;
    }
  </script>
</body>
</html>

